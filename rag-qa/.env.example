# RAG System Environment Configuration

# ================== DeepSeek LLM Configuration ==================
# Get your API key from: https://platform.deepseek.com/api-keys
DEEPSEEK_API_KEY=your_deepseek_api_key_here

# ================== Embedding Model Configuration ==================
# sentence-transformers model for multilingual embeddings
# Options:
#   - sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2 (384 dim, fast, good for Nepali)
#   - sentence-transformers/distiluse-base-multilingual-cased-v2 (512 dim, slightly better)
EMBEDDING_MODEL=sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2

# Device for embedding model: cpu or cuda
EMBEDDING_DEVICE=cpu

# ================== FAISS Configuration ==================
# Path to store FAISS index and metadata
FAISS_INDEX_PATH=data/faiss_index

# FAISS index type: "flat", "ivf", or "hnsw"
# flat: IndexFlatL2 - Exact L2 search (slow, 100% recall)
# ivf: IndexIVFFlat - Approximate, needs training (medium speed)
# hnsw: IndexHNSWFlat - Approximate, graph-based (fast, 95-99% recall) [RECOMMENDED]
FAISS_INDEX_TYPE=hnsw

# IVF Index parameters (only used if FAISS_INDEX_TYPE=ivf)
# nlist: Number of clusters for IVF index (higher = better but slower)
# nprobe: Number of clusters to search (higher = more accurate but slower)
FAISS_NLIST=100
FAISS_NPROBE=10

# HNSW Index parameters (only used if FAISS_INDEX_TYPE=hnsw)
# M: Number of bidirectional links per node (16-64, default: 32)
# Higher = better recall, more memory, slower build
#    32 is good balance for 26K vectors (~3.4 MB overhead)
FAISS_HNSW_M=32

# efConstruction: Build-time ef parameter (64-256, default: 128)
# Higher = better index quality, slower build
#    128 is good balance for 26K vectors
FAISS_HNSW_EF_CONSTRUCTION=128

# efSearch_default: Default search-time ef parameter (16-200, default: 100)
#    Lower = faster search, lower recall
#    64 for fast semantic search with re-ranking (~95% recall)
#    100 for balanced (~98% recall)
#    200 for exact lookups requiring high accuracy (~99%+ recall)
FAISS_HNSW_EF_SEARCH_DEFAULT=100

# Adaptive efSearch tuning (only for HNSW)
#    Enable dynamic efSearch adjustment based on query complexity and performance
FAISS_ENABLE_ADAPTIVE_EF=true

# efSearch bounds for adaptive tuning
#    Minimum efSearch (very fast, lower recall)
FAISS_HNSW_EF_SEARCH_MIN=16

#    Maximum efSearch (slower, higher recall)
FAISS_HNSW_EF_SEARCH_MAX=256

# Performance window for auto-tuning (number of queries to analyze)
FAISS_PERFORMANCE_WINDOW=100

# ================== Retrieval Configuration ==================
# Default number of results to retrieve
DEFAULT_TOP_K=5
MAX_TOP_K=20

# Enable cross-encoder re-ranking (slower but more accurate)
ENABLE_RERANKING=true

# Cross-encoder model for re-ranking
CROSS_ENCODER_MODEL=cross-encoder/ms-marco-MiniLM-L-6-v2

# ================== Data Paths ==================
# Paths to election data files
CANDIDATES_CSV=data/elections/election_candidates-2082.csv
VOTING_CENTERS_CSV=data/elections/voting_centers.csv

# ================== Server Configuration ==================
# RAG service host and port
RAG_HOST=0.0.0.0
RAG_PORT=8002
RAG_RELOAD=false

# ================== CORS Configuration ==================
# Comma-separated list of allowed origins
# Add your frontend URLs here
CORS_ORIGINS=http://localhost:3000,http://localhost:5173,http://127.0.0.1:3000,http://127.0.0.1:5173

# ================== SQLite Configuration ==================
# SQLite database path
SQLITE_DB_PATH=data/elections/election_data.db

# Enable SQLite for structured queries
USE_SQLITE=true

# SQLite connection pool size (number of connections)
SQLITE_POOL_SIZE=5

# Connection pool timeout in seconds
SQLITE_POOL_TIMEOUT=30

# Enable WAL mode for better concurrency
SQLITE_ENABLE_WAL=true

# Cache size in KB (negative = MB, -2000 = 2GB)
SQLITE_CACHE_SIZE=-2000

# ================== Redis Configuration ==================
# Redis server host
REDIS_HOST=localhost

# Redis server port
REDIS_PORT=6379

# Redis database number
REDIS_DB=0

# Redis password (leave empty if no password)
REDIS_PASSWORD=

# Redis connection pool size
REDIS_POOL_SIZE=10

# Redis socket timeout in seconds
REDIS_SOCKET_TIMEOUT=5

# Redis connection timeout in seconds
REDIS_CONNECT_TIMEOUT=5

# ================== Cache Configuration ==================
# Enable response caching
ENABLE_CACHE=true

# Cache TTL in seconds (default: 1 hour)
CACHE_TTL=3600

# Query results cache TTL in seconds (1 hour)
CACHE_QUERY_TTL=3600

# Embeddings cache TTL in seconds (24 hours)
CACHE_EMBEDDING_TTL=86400

# SQL query results cache TTL in seconds (30 minutes)
CACHE_SQL_TTL=1800

# FAISS search results cache TTL in seconds (15 minutes)
CACHE_FAISS_TTL=900

# ================== Performance Monitoring ==================
# Enable performance metrics collection
ENABLE_PERFORMANCE_METRICS=true

# Slow query threshold in milliseconds
SLOW_QUERY_THRESHOLD_MS=100

# Log index usage information
LOG_INDEX_USAGE=true

# Track query performance for auto-tuning
TRACK_QUERY_PERFORMANCE=true

# ================== Logging Configuration ==================
# Log level: DEBUG, INFO, WARNING, ERROR
LOG_LEVEL=INFO
